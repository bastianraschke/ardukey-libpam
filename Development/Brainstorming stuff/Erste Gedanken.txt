PAM-Flags:

- Paranoid-Flag für PAM Modul, falls z.B. Netzwerkverbindung nicht verfügbar:
  - wenn gesetzt: Authentifizierung abbrechen
  - wenn nicht gesetzt: Login durch anderes Modul in PAM-Kette zulassen

- Debug-Flag -> mehr Infos loggen

PAM-Modul kann im Request vom Auth-server zusätzlich timestamp anfordern
-> feingranularere Prüfung auf Seite des PAM-Moduls möglich

Auch bei anderen Zertifikaten darf kein Zertifikatserror entstehen (und somit folgende rejection)

OTP muss rückziehbar sein

Gerät muss identity gebunden sein -> nicht einfach jedes device für "chef" account verwendbar

---

1) Trudy meldet sich als root an
2) Trudy gibt Root-Passwort korrekt ein
3) Trudy sendet OTP durch ihren ArduKey zum Authserver
4) Vor der Response ändert Trudy ihr Mapping-Datei, auf den Public ID des root
5) PAM-Modul checkt Mapping-Datei und gibt OK :/

Lösung:

Da Trudy sich als root anmeldet, wird in dessen Mapping-Datei geguckt, auf welche Trudy keinen Zugriff haben sollte.
